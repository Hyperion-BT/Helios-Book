# `FuzzyTest`

Helper class for performing fuzzy property-based tests of Helios scripts.

## Constructor

```ts
new helios.FuzzyTest(
    seed: number = 0,
    runsPerTest: number = 100,
    simplify: boolean = false
)
```

The `simplify` argument specifies whether optimized versions of the Helios sources should also be tested.

## Methods

### `ascii`

Returns a generator for [`ByteArrayData`](./bytearraydata.md) instances representing ascii strings.

The generated data is wrapped with [`UplcDataValue`](./uplcdatavalue.md).

```ts
fuzzy_test.ascii(
    minLength: number = 0,
    maxLength: number = 64
): (() => helios.UplcValue)
```

### `bool`

Returns a generator for primitive boolean instances.

```ts
fuzzy_test.bool()
```

### `bytes`

Returns a generator for [`ByteArrayData`](./bytearraydata.md).

The generated data is wrapped with [`UplcDataValue`](./uplcdatavalue.md).

```ts
fuzzy_test.bytes(
    minLength: number = 0,
    maxLength: number = 64
): (() => helios.UplcValue)
```

### `int`

Returns a generator for [`IntData`](./intdata.md).

The generated data is wrapped with [`UplcDataValue`](./uplcdatavalue.md).

```ts
fuzzy_test.int(
    min: number = -10000000,
    max: number =  10000000
): (() => helios.UplcValue)
```

### `list`

Returns a generator for [`ListData`](./listdata.md), where every item is generated by the given `itemGenerator`.

The generated data is wrapped with [`UplcDataValue`](./uplcdatavalue.md).

```ts
fuzzy_test.list(
    itemGenerator: () => helios.UplcValue,
    minLength: number = 0,
    maxLength: number = 10
): (() => helios.UplcValue)
```

### `map`

Returns a generator for [`MapData`](./mapdata.md), where every key and value is generated by the given `keyGenerator` and `valueGenerator` respectively.

The generated data is wrapped with [`UplcDataValue`](./uplcdatavalue.md).

```ts
fuzzy_test.map(
    keyGenerator: () => helios.UplcValue,
    valueGenerator: () => helios.UplcValue,
    minLength: number = 0,
    maxLength: number = 10
): (() => helios.UplcValue)
```

### `option`

Returns a generator for [`ConstrData`](./constrdata.md) instances representing random options. The probability of *none* occurences can be configured.

The generated data is wrapped with [`UplcDataValue`](./uplcdatavalue.md).

```ts
fuzzy_test.option(
    someGenerator: () => helios.UplcValue,
    noneProbability: number = 0.5
): (() => helios.UplcValue)
```

### `string`

Returns a generator for [`ByteArrayData`](./bytearraydata.md) instances representing utf-8 strings.

The generated data is wrapped with [`UplcDataValue`](./uplcdatavalue.md).

```ts
fuzzy_test.string(
    minLength: number = 0,
    maxLength: number = 64
): (() => helios.UplcValue)
```

### `test`

Perform a fuzzy/property-based test-run of a Helios source. One value generator must be specified per argument of `main`.

Throws an error if the `propTest` fails.

The `propTest` can simply return a `boolean`, or can return an object with boolean values, and if any of these booleans is `false` the `propTest` fails (the keys can be used to provide extra information).

```ts
fuzzy_test.test(
    argGens: (() => helios.UplcValue)[],
    src: string,
    propTest: (
        args: helios.UplcValue[], 
        res: helios.UplcValue | helios.UserError
    ) => (boolean | Object.<string, boolean>)
): Promise<void>
```